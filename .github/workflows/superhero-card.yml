name: "‚öîÔ∏è GENSHIN DEV CARD"

on:
  workflow_dispatch:
    inputs:
      github_user:
        description: 'Usu√°rio do GitHub'
        required: true
        default: 'ciconha'
      character_name:
        description: 'Nome do Personagem'
        required: false
        default: ''
      character_class:
        description: 'Classe (Warrior, Mage, Archer, etc)'
        required: false
        default: 'Code Mage'
      element:
        description: 'Elemento (Pyro, Hydro, Electro, etc)'
        required: false
        default: 'Electro'
      region:
        description: 'Regi√£o/Nacionalidade'
        required: false
        default: 'Brasil'
      
      # Stats personalizados
      weapon_type:
        description: 'Tipo de Arma (Sword, Catalyst, Bow, etc)'
        required: false
        default: 'Catalyst'
      special_skill:
        description: 'Habilidade Especial'
        required: false
        default: 'Code Storm'
      playstyle:
        description: 'Estilo de jogo (Aggressive, Support, Hybrid)'
        required: false
        default: 'Hybrid'

permissions:
  contents: write

jobs:
  create-genshin-card:
    runs-on: ubuntu-latest
    
    steps:
      - name: üì• Checkout do reposit√≥rio
        uses: actions/checkout@v4
      
      - name: ‚öôÔ∏è Instalar depend√™ncias
        run: |
          sudo apt-get update -y
          sudo apt-get install -y curl jq bc
      
      - name: üîç Buscar dados do GitHub
        id: github-data
        env:
          GH_TOKEN: ${{ secrets.Ciconha_tsukuyomi }}
        run: |
          USER="${{ github.event.inputs.github_user }}"
          
          echo "üéÆ Buscando dados de Teyvat para: $USER"
          
          # Sanitizar nome de usu√°rio
          CLEAN_USER=$(echo "$USER" | tr -cd '[:alnum:]_-')
          
          # URL segura para avatar (sem token se n√£o for necess√°rio)
          AVATAR_URL="https://github.com/$CLEAN_USER.png?size=200"
          
          # Tentar buscar dados da API se token existir
          if [ -n "$GH_TOKEN" ] && [ "$GH_TOKEN" != "" ]; then
            echo "üîë Usando token para API..."
            curl -s -H "Authorization: token $GH_TOKEN" \
                 "https://api.github.com/users/$CLEAN_USER" > user.json 2>/dev/null || true
            curl -s -H "Authorization: token $GH_TOKEN" \
                 "https://api.github.com/users/$CLEAN_USER/repos?sort=stars&per_page=100" > repos.json 2>/dev/null || true
          else
            echo "‚ö†Ô∏è Sem token, usando API p√∫blica..."
            curl -s "https://api.github.com/users/$CLEAN_USER" > user.json 2>/dev/null || true
            curl -s "https://api.github.com/users/$CLEAN_USER/repos?sort=stars&per_page=100" > repos.json 2>/dev/null || true
          fi
          
          # Verificar se user.json existe e tem dados
          if [ ! -f user.json ] || [ ! -s user.json ] || ! jq -e '.login' user.json >/dev/null 2>&1; then
            echo "‚ö†Ô∏è Dados do GitHub n√£o encontrados, usando padr√£o"
            PUBLIC_REPOS=0
            FOLLOWERS=0
            STARS_TOTAL=0
            USER_BIO="Traveler from another world"
          else
            # Extrair dados com fallbacks
            PUBLIC_REPOS=$(jq -r '.public_repos // 0' user.json)
            FOLLOWERS=$(jq -r '.followers // 0' user.json)
            
            # Bio (manter original)
            USER_BIO_RAW=$(jq -r '.bio // "Traveler from another world"' user.json)
            USER_BIO=$(echo "$USER_BIO_RAW" | sed 's/\\n/ /g; s/\\r/ /g' | head -c 150)
            
            # Calcular estrelas totais
            if [ -f repos.json ] && [ -s repos.json ]; then
              STARS_TOTAL=$(jq '[.[].stargazers_count // 0] | add' repos.json 2>/dev/null || echo "0")
            else
              STARS_TOTAL=0
            fi
          fi
          
          # Top projetos (m√°ximo 3)
          echo '[]' > top_projects.json
          if [ -f repos.json ] && [ -s repos.json ]; then
            jq '[.[0:3] | .[] | {name: (.name // "Unknown"), stars: (.stargazers_count // 0), language: (.language // "Unknown")}]' repos.json > top_projects.json 2>/dev/null || true
          fi
          
          # C√°lculo de XP e Level (sistema Genshin-like)
          # XP = (repos * 100) + (followers * 50) + (stars * 10)
          TOTAL_XP=$((PUBLIC_REPOS * 100 + FOLLOWERS * 50 + STARS_TOTAL * 10))
          if [ $TOTAL_XP -lt 1 ]; then
            TOTAL_XP=100
          fi
          
          # N√≠vel: cada n√≠vel requer XP * n√≠vel anterior * 1.5
          # N√≠vel 1: 0-100 XP, N√≠vel 2: 101-250, etc
          LEVEL=1
          XP_REQUIRED=100
          XP_CURRENT=$TOTAL_XP
          
          while [ $XP_CURRENT -ge $XP_REQUIRED ] && [ $LEVEL -lt 90 ]; do
            XP_CURRENT=$((XP_CURRENT - XP_REQUIRED))
            LEVEL=$((LEVEL + 1))
            XP_REQUIRED=$(echo "$XP_REQUIRED * 1.5" | bc | cut -d. -f1)
            if [ $XP_REQUIRED -lt 100 ]; then
              XP_REQUIRED=100
            fi
          done
          
          # Garantir n√≠vel m√≠nimo 1 e m√°ximo 90
          if [ $LEVEL -lt 1 ]; then LEVEL=1; fi
          if [ $LEVEL -gt 90 ]; then LEVEL=90; fi
          
          # Percentual para pr√≥xima level
          if [ $LEVEL -eq 90 ]; then
            XP_PERCENT=100
          else
            XP_PERCENT=$((XP_CURRENT * 100 / XP_REQUIRED))
          fi
          
          # Sistema de Ranking (F a S)
          if [ $LEVEL -ge 80 ]; then RANK="S"
          elif [ $LEVEL -ge 70 ]; then RANK="A+"
          elif [ $LEVEL -ge 60 ]; then RANK="A"
          elif [ $LEVEL -ge 50 ]; then RANK="B+"
          elif [ $LEVEL -ge 40 ]; then RANK="B"
          elif [ $LEVEL -ge 30 ]; then RANK="C+"
          elif [ $LEVEL -ge 20 ]; then RANK="C"
          elif [ $LEVEL -ge 10 ]; then RANK="D"
          else RANK="F"
          fi
          
          # Cores baseadas no elemento
          case "${{ github.event.inputs.element }}" in
            "Pyro") ELEMENT_COLOR="#FF6B35" ;;
            "Hydro") ELEMENT_COLOR="#00A8E8" ;;
            "Electro") ELEMENT_COLOR="#9D4EDD" ;;
            "Anemo") ELEMENT_COLOR="#38B000" ;;
            "Geo") ELEMENT_COLOR="#FF9E00" ;;
            "Cryo") ELEMENT_COLOR="#90E0EF" ;;
            "Dendro") ELEMENT_COLOR="#70E000" ;;
            *) ELEMENT_COLOR="#6A0572" ;;
          esac
          
          # Outputs seguros
          echo "avatar_url=$AVATAR_URL" >> $GITHUB_OUTPUT
          echo "public_repos=$PUBLIC_REPOS" >> $GITHUB_OUTPUT
          echo "followers=$FOLLOWERS" >> $GITHUB_OUTPUT
          echo "stars_total=$STARS_TOTAL" >> $GITHUB_OUTPUT
          echo "user_bio=$USER_BIO" >> $GITHUB_OUTPUT
          echo "total_xp=$TOTAL_XP" >> $GITHUB_OUTPUT
          echo "level=$LEVEL" >> $GITHUB_OUTPUT
          echo "xp_percent=$XP_PERCENT" >> $GITHUB_OUTPUT
          echo "rank=$RANK" >> $GITHUB_OUTPUT
          echo "element_color=$ELEMENT_COLOR" >> $GITHUB_OUTPUT
          
          echo "üéØ Dados calculados:"
          echo "‚öîÔ∏è  N√≠vel: $LEVEL"
          echo "‚≠ê Rank: $RANK"
          echo "üìà XP Total: $TOTAL_XP"
          echo "üìä Pr√≥ximo n√≠vel: $XP_PERCENT%"
      
      - name: üé® Criar diret√≥rio para cards
        run: mkdir -p cards
      
      - name: üñºÔ∏è Gerar Card Genshin Style
        run: |
          # Dados calculados
          AVATAR_URL="${{ steps.github-data.outputs.avatar_url }}"
          PUBLIC_REPOS="${{ steps.github-data.outputs.public_repos }}"
          FOLLOWERS="${{ steps.github-data.outputs.followers }}"
          STARS_TOTAL="${{ steps.github-data.outputs.stars_total }}"
          USER_BIO="${{ steps.github-data.outputs.user_bio }}"
          TOTAL_XP="${{ steps.github-data.outputs.total_xp }}"
          LEVEL="${{ steps.github-data.outputs.level }}"
          XP_PERCENT="${{ steps.github-data.outputs.xp_percent }}"
          RANK="${{ steps.github-data.outputs.rank }}"
          ELEMENT_COLOR="${{ steps.github-data.outputs.element_color }}"
          
          # Inputs do usu√°rio
          CHARACTER_NAME="${{ github.event.inputs.character_name }}"
          if [ -z "$CHARACTER_NAME" ] || [ "$CHARACTER_NAME" = "null" ]; then
            CHARACTER_NAME="${{ github.event.inputs.github_user }}"
          fi
          
          CHARACTER_CLASS="${{ github.event.inputs.character_class }}"
          ELEMENT="${{ github.event.inputs.element }}"
          REGION="${{ github.event.inputs.region }}"
          WEAPON_TYPE="${{ github.event.inputs.weapon_type }}"
          SPECIAL_SKILL="${{ github.event.inputs.special_skill }}"
          PLAYSTYLE="${{ github.event.inputs.playstyle }}"
          
          # Data atual
          DATE=$(date +'%d/%m/%Y')
          TIME=$(date +'%H:%M')
          
          # Nome do arquivo
          FILENAME=$(echo "$CHARACTER_NAME" | tr ' ' '_' | tr -cd '[:alnum:]_-')
          if [ -z "$FILENAME" ]; then
            FILENAME="genshin_card"
          fi
          SVG_FILE="cards/${FILENAME}.svg"
          
          # Ler projetos top
          PROJECT1_NAME="No repositories"
          PROJECT1_STARS="0"
          PROJECT1_LANG="???"
          PROJECT2_NAME="No repositories"
          PROJECT2_STARS="0"
          PROJECT2_LANG="???"
          PROJECT3_NAME="No repositories"
          PROJECT3_STARS="0"
          PROJECT3_LANG="???"
          
          if [ -f top_projects.json ]; then
            # Projeto 1
            P1_NAME=$(jq -r '.[0].name // "No repositories"' top_projects.json 2>/dev/null)
            P1_STARS=$(jq -r '.[0].stars // 0' top_projects.json 2>/dev/null)
            P1_LANG=$(jq -r '.[0].language // "???"' top_projects.json 2>/dev/null)
            
            if [ "$P1_NAME" != "null" ] && [ -n "$P1_NAME" ]; then
              PROJECT1_NAME="$P1_NAME"
              PROJECT1_STARS="$P1_STARS"
              PROJECT1_LANG="$P1_LANG"
            fi
            
            # Projeto 2
            P2_NAME=$(jq -r '.[1].name // "No repositories"' top_projects.json 2>/dev/null)
            P2_STARS=$(jq -r '.[1].stars // 0' top_projects.json 2>/dev/null)
            P2_LANG=$(jq -r '.[1].language // "???"' top_projects.json 2>/dev/null)
            
            if [ "$P2_NAME" != "null" ] && [ -n "$P2_NAME" ]; then
              PROJECT2_NAME="$P2_NAME"
              PROJECT2_STARS="$P2_STARS"
              PROJECT2_LANG="$P2_LANG"
            fi
            
            # Projeto 3
            P3_NAME=$(jq -r '.[2].name // "No repositories"' top_projects.json 2>/dev/null)
            P3_STARS=$(jq -r '.[2].stars // 0' top_projects.json 2>/dev/null)
            P3_LANG=$(jq -r '.[2].language // "???"' top_projects.json 2>/dev/null)
            
            if [ "$P3_NAME" != "null" ] && [ -n "$P3_NAME" ]; then
              PROJECT3_NAME="$P3_NAME"
              PROJECT3_STARS="$P3_STARS"
              PROJECT3_LANG="$P3_LANG"
            fi
          fi
          
          # Limitar tamanho dos nomes dos projetos
          PROJECT1_NAME=$(echo "$PROJECT1_NAME" | cut -c1-20)
          PROJECT2_NAME=$(echo "$PROJECT2_NAME" | cut -c1-20)
          PROJECT3_NAME=$(echo "$PROJECT3_NAME" | cut -c1-20)
          
          # Fun√ß√£o de escape para SVG
          escape_svg() {
            echo "$1" | sed \
              -e 's/&/\&amp;/g' \
              -e 's/</\&lt;/g' \
              -e 's/>/\&gt;/g' \
              -e 's/"/\&quot;/g' \
              -e "s/'/\&apos;/g"
          }
          
          # Escapar strings
          CHAR_NAME_ESC=$(escape_svg "$CHARACTER_NAME")
          CHAR_CLASS_ESC=$(escape_svg "$CHARACTER_CLASS")
          ELEMENT_ESC=$(escape_svg "$ELEMENT")
          REGION_ESC=$(escape_svg "$REGION")
          WEAPON_ESC=$(escape_svg "$WEAPON_TYPE")
          SKILL_ESC=$(escape_svg "$SPECIAL_SKILL")
          PLAYSTYLE_ESC=$(escape_svg "$PLAYSTYLE")
          BIO_ESC=$(escape_svg "$USER_BIO")
          PROJECT1_NAME_ESC=$(escape_svg "$PROJECT1_NAME")
          PROJECT1_LANG_ESC=$(escape_svg "$PROJECT1_LANG")
          PROJECT2_NAME_ESC=$(escape_svg "$PROJECT2_NAME")
          PROJECT2_LANG_ESC=$(escape_svg "$PROJECT2_LANG")
          PROJECT3_NAME_ESC=$(escape_svg "$PROJECT3_NAME")
          PROJECT3_LANG_ESC=$(escape_svg "$PROJECT3_LANG")
          
          # Cores baseadas no rank
          case "$RANK" in
            "S") RANK_COLOR="#FFD700"; RANK_GLOW="#FFA500" ;;
            "A+") RANK_COLOR="#FF6B6B"; RANK_GLOW="#FF3333" ;;
            "A") RANK_COLOR="#FF8E8E"; RANK_GLOW="#FF6B6B" ;;
            "B+") RANK_COLOR="#4ECDC4"; RANK_GLOW="#26A69A" ;;
            "B") RANK_COLOR="#95E1D3"; RANK_GLOW="#4ECDC4" ;;
            "C+") RANK_COLOR="#FFD166"; RANK_GLOW="#FFB347" ;;
            "C") RANK_COLOR="#FFE8A0"; RANK_GLOW="#FFD166" ;;
            "D") RANK_COLOR="#A0A0A0"; RANK_GLOW="#808080" ;;
            *) RANK_COLOR="#808080"; RANK_GLOW="#606060" ;;
          esac
          
          # Calcular largura da barra de XP
          BAR_WIDTH=$((350 * XP_PERCENT / 100))
          if [ $BAR_WIDTH -gt 350 ]; then BAR_WIDTH=350; fi
          if [ $BAR_WIDTH -lt 0 ]; then BAR_WIDTH=0; fi
          
          # Criar SVG Genshin Impact Style
          cat > "$SVG_FILE" << EOF
          <svg xmlns="http://www.w3.org/2000/svg" width="600" height="800" viewBox="0 0 600 800">
          <defs>
            <style>
              @import url('https://fonts.googleapis.com/css2?family=Genshin+Impact&family=Noto+Sans+JP:wght@300;400;500;700&family=Orbitron:wght@400;500;700&display=swap');
              
              .genshin-font {
                font-family: 'Genshin Impact', 'Noto Sans JP', sans-serif;
              }
              
              .title-text {
                font-family: 'Genshin Impact', 'Noto Sans JP', sans-serif;
                font-size: 32px;
                font-weight: 700;
                fill: white;
                text-shadow: 0 0 10px $ELEMENT_COLOR, 0 0 20px $ELEMENT_COLOR;
                letter-spacing: 1px;
              }
              
              .subtitle-text {
                font-family: 'Noto Sans JP', sans-serif;
                font-size: 18px;
                font-weight: 500;
                fill: #E0E0FF;
                letter-spacing: 0.5px;
              }
              
              .stat-label {
                font-family: 'Noto Sans JP', sans-serif;
                font-size: 14px;
                font-weight: 400;
                fill: #B0B0D0;
                text-transform: uppercase;
                letter-spacing: 1px;
              }
              
              .stat-value {
                font-family: 'Orbitron', monospace;
                font-size: 16px;
                font-weight: 700;
                fill: white;
              }
              
              .rank-text {
                font-family: 'Genshin Impact', 'Noto Sans JP', sans-serif;
                font-size: 48px;
                font-weight: 900;
                fill: $RANK_COLOR;
                text-shadow: 0 0 15px $RANK_GLOW, 0 0 30px $RANK_GLOW;
              }
              
              .level-text {
                font-family: 'Orbitron', monospace;
                font-size: 28px;
                font-weight: 900;
                fill: white;
                text-shadow: 0 0 10px $ELEMENT_COLOR;
              }
              
              .xp-text {
                font-family: 'Noto Sans JP', sans-serif;
                font-size: 12px;
                fill: #D0D0FF;
              }
              
              .project-text {
                font-family: 'Noto Sans JP', sans-serif;
                font-size: 11px;
                fill: #C0C0E0;
              }
              
              .project-title {
                font-family: 'Noto Sans JP', sans-serif;
                font-size: 13px;
                font-weight: 600;
                fill: white;
              }
              
              .bio-text {
                font-family: 'Noto Sans JP', sans-serif;
                font-size: 12px;
                fill: #D0D0FF;
                line-height: 1.4;
              }
            </style>
            
            <!-- Gradientes Genshin Style -->
            <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#0A0A1A"/>
              <stop offset="50%" stop-color="#1A1A2E"/>
              <stop offset="100%" stop-color="#0A0A1A"/>
            </linearGradient>
            
            <linearGradient id="elementGradient" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="$ELEMENT_COLOR"/>
              <stop offset="50%" stop-color="#FFFFFF"/>
              <stop offset="100%" stop-color="$ELEMENT_COLOR"/>
            </linearGradient>
            
            <linearGradient id="xpBarGradient" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#FFD700"/>
              <stop offset="50%" stop-color="#FFA500"/>
              <stop offset="100%" stop-color="#FFD700"/>
            </linearGradient>
            
            <linearGradient id="cardGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#1E1E2E" stop-opacity="0.9"/>
              <stop offset="100%" stop-color="#2D2D44" stop-opacity="0.9"/>
            </linearGradient>
            
            <!-- Padr√£o de estrelas -->
            <pattern id="starPattern" width="20" height="20" patternUnits="userSpaceOnUse">
              <circle cx="2" cy="2" r="1" fill="#FFFFFF" opacity="0.3"/>
              <circle cx="10" cy="15" r="1" fill="#FFFFFF" opacity="0.3"/>
              <circle cx="18" cy="5" r="1" fill="#FFFFFF" opacity="0.3"/>
            </pattern>
            
            <!-- Filtros de efeito -->
            <filter id="glow">
              <feGaussianBlur stdDeviation="3" result="blur"/>
              <feMerge>
                <feMergeNode in="blur"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
            
            <filter id="dropShadow">
              <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="#000000" flood-opacity="0.5"/>
            </filter>
          </defs>
          
          <!-- Fundo c√≥smico -->
          <rect width="600" height="800" fill="url(#bgGradient)"/>
          <rect width="600" height="800" fill="url(#starPattern)" opacity="0.1"/>
          
          <!-- Elementos decorativos de fundo -->
          <circle cx="100" cy="100" r="50" fill="$ELEMENT_COLOR" opacity="0.1" filter="url(#glow)"/>
          <circle cx="500" cy="700" r="80" fill="$ELEMENT_COLOR" opacity="0.1" filter="url(#glow)"/>
          <rect x="200" y="300" width="200" height="200" rx="20" transform="rotate(45 300 400)" fill="$ELEMENT_COLOR" opacity="0.05"/>
          
          <!-- Card principal -->
          <g filter="url(#dropShadow)">
            <rect x="30" y="30" width="540" height="740" rx="25" fill="url(#cardGradient)" stroke="$ELEMENT_COLOR" stroke-width="2" opacity="0.95"/>
          </g>
          
          <!-- Cabe√ßalho com elemento -->
          <rect x="30" y="30" width="540" height="100" rx="25" fill="$ELEMENT_COLOR" opacity="0.3"/>
          <rect x="30" y="30" width="540" height="100" rx="25" fill="none" stroke="$ELEMENT_COLOR" stroke-width="3" opacity="0.7"/>
          
          <!-- Nome do personagem -->
          <text x="300" y="85" text-anchor="middle" class="title-text">$CHAR_NAME_ESC</text>
          
          <!-- Classe e Elemento -->
          <text x="300" y="115" text-anchor="middle" class="subtitle-text">$CHAR_CLASS_ESC ‚Ä¢ $ELEMENT_ESC</text>
          
          <!-- N√≠vel e Rank -->
          <g transform="translate(50, 160)">
            <!-- N√≠vel -->
            <rect x="0" y="0" width="150" height="60" rx="15" fill="#2A2A3A" opacity="0.8"/>
            <text x="75" y="25" text-anchor="middle" class="stat-label">N√çVEL</text>
            <text x="75" y="50" text-anchor="middle" class="level-text">$LEVEL</text>
            
            <!-- Rank -->
            <rect x="180" y="0" width="150" height="60" rx="15" fill="#2A2A3A" opacity="0.8"/>
            <text x="255" y="25" text-anchor="middle" class="stat-label">RANK</text>
            <text x="255" y="55" text-anchor="middle" class="rank-text">$RANK</text>
            
            <!-- XP Total -->
            <rect x="360" y="0" width="150" height="60" rx="15" fill="#2A2A3A" opacity="0.8"/>
            <text x="435" y="25" text-anchor="middle" class="stat-label">XP TOTAL</text>
            <text x="435" y="50" text-anchor="middle" class="stat-value">$TOTAL_XP</text>
          </g>
          
          <!-- Barra de XP (Estilo Trash Rock) -->
          <g transform="translate(50, 240)">
            <text x="0" y="0" class="stat-label">EXPERI√äNCIA</text>
            <text x="400" y="0" class="xp-text" text-anchor="end">$XP_PERCENT% para o pr√≥ximo n√≠vel</text>
            
            <!-- Barra de fundo -->
            <rect x="0" y="20" width="400" height="20" rx="10" fill="#1A1A2A"/>
            <rect x="0" y="20" width="400" height="20" rx="10" fill="none" stroke="#333344" stroke-width="2"/>
            
            <!-- Barra de XP preenchida -->
            <rect x="0" y="20" width="$BAR_WIDTH" height="20" rx="10" fill="url(#xpBarGradient)"/>
            
            <!-- Efeito de brilho na barra -->
            <rect x="0" y="20" width="$BAR_WIDTH" height="20" rx="10" fill="none" stroke="#FFD700" stroke-width="1" opacity="0.5"/>
            
            <!-- Marcadores de n√≠vel -->
            <circle cx="50" cy="30" r="3" fill="white" opacity="0.5"/>
            <circle cx="150" cy="30" r="3" fill="white" opacity="0.5"/>
            <circle cx="250" cy="30" r="3" fill="white" opacity="0.5"/>
            <circle cx="350" cy="30" r="3" fill="white" opacity="0.5"/>
          </g>
          
          <!-- Stats do GitHub -->
          <g transform="translate(50, 300)">
            <text x="0" y="0" class="stat-label">STATS DO GITHUB</text>
            
            <g transform="translate(0, 30)">
              <!-- Reposit√≥rios -->
              <rect x="0" y="0" width="160" height="70" rx="15" fill="#252535" opacity="0.8"/>
              <text x="80" y="25" text-anchor="middle" class="stat-label">Reposit√≥rios</text>
              <text x="80" y="50" text-anchor="middle" class="stat-value">$PUBLIC_REPOS</text>
              
              <!-- Seguidores -->
              <rect x="180" y="0" width="160" height="70" rx="15" fill="#252535" opacity="0.8"/>
              <text x="260" y="25" text-anchor="middle" class="stat-label">Seguidores</text>
              <text x="260" y="50" text-anchor="middle" class="stat-value">$FOLLOWERS</text>
              
              <!-- Estrelas -->
              <rect x="360" y="0" width="160" height="70" rx="15" fill="#252535" opacity="0.8"/>
              <text x="440" y="25" text-anchor="middle" class="stat-label">Estrelas</text>
              <text x="440" y="50" text-anchor="middle" class="stat-value">$STARS_TOTAL</text>
            </g>
          </g>
          
          <!-- Informa√ß√µes do Personagem -->
          <g transform="translate(50, 400)">
            <text x="0" y="0" class="stat-label">INFORMA√á√ïES</text>
            
            <g transform="translate(0, 30)">
              <!-- Regi√£o -->
              <rect x="0" y="0" width="250" height="40" rx="10" fill="#2A2A3A" opacity="0.7"/>
              <text x="15" y="15" class="stat-label" font-size="12">üè∞ Regi√£o</text>
              <text x="15" y="30" class="stat-value" font-size="14">$REGION_ESC</text>
              
              <!-- Arma -->
              <rect x="270" y="0" width="250" height="40" rx="10" fill="#2A2A3A" opacity="0.7"/>
              <text x="285" y="15" class="stat-label" font-size="12">‚öîÔ∏è Arma</text>
              <text x="285" y="30" class="stat-value" font-size="14">$WEAPON_ESC</text>
              
              <!-- Estilo -->
              <rect x="0" y="50" width="250" height="40" rx="10" fill="#2A2A3A" opacity="0.7"/>
              <text x="15" y="65" class="stat-label" font-size="12">üé≠ Estilo</text>
              <text x="15" y="80" class="stat-value" font-size="14">$PLAYSTYLE_ESC</text>
              
              <!-- Habilidade -->
              <rect x="270" y="50" width="250" height="40" rx="10" fill="#2A2A3A" opacity="0.7"/>
              <text x="285" y="65" class="stat-label" font-size="12">‚ú® Habilidade</text>
              <text x="285" y="80" class="stat-value" font-size="14">$SKILL_ESC</text>
            </g>
          </g>
          
          <!-- Bio -->
          <g transform="translate(50, 500)">
            <rect x="0" y="0" width="500" height="60" rx="10" fill="#2A2A3A" opacity="0.7"/>
            <text x="15" y="20" class="stat-label">üìñ BIOGRAFIA</text>
            <text x="15" y="40" class="bio-text">$BIO_ESC</text>
          </g>
          
          <!-- Projetos Top -->
          <g transform="translate(50, 580)">
            <text x="0" y="0" class="stat-label">PROJETOS DESTAQUES</text>
            
            <g transform="translate(0, 30)">
              <!-- Projeto 1 -->
              <rect x="0" y="0" width="160" height="80" rx="15" fill="#252535" opacity="0.8"/>
              <text x="80" y="20" text-anchor="middle" class="project-title">$PROJECT1_NAME_ESC</text>
              <text x="80" y="35" text-anchor="middle" class="project-text">‚≠ê $PROJECT1_STARS estrelas</text>
              <text x="80" y="50" text-anchor="middle" class="project-text">üîß $PROJECT1_LANG_ESC</text>
              
              <!-- Projeto 2 -->
              <rect x="180" y="0" width="160" height="80" rx="15" fill="#252535" opacity="0.8"/>
              <text x="260" y="20" text-anchor="middle" class="project-title">$PROJECT2_NAME_ESC</text>
              <text x="260" y="35" text-anchor="middle" class="project-text">‚≠ê $PROJECT2_STARS estrelas</text>
              <text x="260" y="50" text-anchor="middle" class="project-text">üîß $PROJECT2_LANG_ESC</text>
              
              <!-- Projeto 3 -->
              <rect x="360" y="0" width="160" height="80" rx="15" fill="#252535" opacity="0.8"/>
              <text x="440" y="20" text-anchor="middle" class="project-title">$PROJECT3_NAME_ESC</text>
              <text x="440" y="35" text-anchor="middle" class="project-text">‚≠ê $PROJECT3_STARS estrelas</text>
              <text x="440" y="50" text-anchor="middle" class="project-text">üîß $PROJECT3_LANG_ESC</text>
            </g>
          </g>
          
          <!-- Footer -->
          <g transform="translate(50, 690)">
            <rect x="0" y="0" width="500" height="40" rx="10" fill="#1A1A2A" opacity="0.8"/>
            <text x="15" y="25" class="project-text">üéÆ Genshin Dev Card ‚Ä¢ $DATE $TIME</text>
            <text x="485" y="25" class="project-text" text-anchor="end">N√≠vel $LEVEL ‚Ä¢ Rank $RANK</text>
          </g>
          
          <!-- Efeitos decorativos -->
          <!-- Estrelas brilhantes -->
          <circle cx="550" cy="150" r="2" fill="#FFD700" opacity="0.8">
            <animate attributeName="opacity" values="0.3;1;0.3" dur="2s" repeatCount="indefinite"/>
          </circle>
          <circle cx="50" cy="250" r="2" fill="#00A8E8" opacity="0.8">
            <animate attributeName="opacity" values="0.3;1;0.3" dur="2.5s" repeatCount="indefinite"/>
          </circle>
          <circle cx="400" cy="500" r="2" fill="#FF6B35" opacity="0.8">
            <animate attributeName="opacity" values="0.3;1;0.3" dur="3s" repeatCount="indefinite"/>
          </circle>
          
          <!-- Elemento flutuante -->
          <path d="M300 750 Q320 730 340 750 T380 750" fill="none" stroke="$ELEMENT_COLOR" stroke-width="2" opacity="0.5">
            <animate attributeName="d" values="M300 750 Q320 730 340 750 T380 750;M300 750 Q320 770 340 750 T380 750;M300 750 Q320 730 340 750 T380 750" dur="4s" repeatCount="indefinite"/>
          </path>
          
          </svg>
          
          echo "‚ú® Card Genshin criado: $SVG_FILE"
          echo "üéÆ Estilo: Genshin Impact"
          echo "‚öîÔ∏è N√≠vel: $LEVEL"
          echo "‚≠ê Rank: $RANK"
          echo "üìà XP: $TOTAL_XP ($XP_PERCENT% para pr√≥ximo)"
          echo "üî• Elemento: $ELEMENT"
      
      - name: üì§ Salvar card
        run: |
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"
          
          git add cards/
          git commit -m "‚öîÔ∏è Add Genshin card: ${{ github.event.inputs.github_user }} (N√≠vel ${{ steps.github-data.outputs.level }})" || echo "Sem altera√ß√µes"
          git push || echo "Push falhou ou sem altera√ß√µes"
          echo "‚úÖ Workflow completo!"
