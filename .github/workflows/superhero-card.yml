name: "ðŸŽ´ ANIME SUPERHERO CARD"

on:
  workflow_dispatch:
    inputs:
      github_user:
        description: 'UsuÃ¡rio do GitHub (para foto)'
        required: true
        default: 'ciconha'
      hero_name:
        description: 'Nome do HerÃ³i'
        required: true
        default: 'H/N'
      hero_class:
        description: 'Classe'
        required: false
        default: 'Superhero'
      guild:
        description: 'Guilda/AfiliaÃ§Ã£o'
        required: false
        default: '14Ball Official'
      species:
        description: 'EspÃ©cie'
        required: false
        default: 'Human'
      backstory:
        description: 'HistÃ³ria (curta)'
        required: false
        default: 'From another dimension. Expert fighter with vast knowledge.'
      
      # Stats
      strength:
        description: 'ForÃ§a (1-10)'
        required: false
        default: '7'
      health:
        description: 'SaÃºde (1-10)'
        required: false
        default: '8'
      magic:
        description: 'Poder MÃ¡gico (1-10)'
        required: false
        default: '5'
      dexterity:
        description: 'Destreza (1-10)'
        required: false
        default: '9'
      agility:
        description: 'Agilidade (1-10)'
        required: false
        default: '8'
      luck:
        description: 'Sorte (1-10)'
        required: false
        default: '6'
      
      # Skills
      skill_1:
        description: 'Habilidade 1'
        required: false
        default: 'Determination'
      skill_2:
        description: 'Habilidade 2'
        required: false
        default: 'Spinitzu'
      skill_3:
        description: 'Habilidade 3'
        required: false
        default: ''
      skill_4:
        description: 'Habilidade 4'
        required: false
        default: ''
      
      # Ranking
      ranking:
        description: 'Ranking (S, A, B, C)'
        required: false
        default: 'A'

permissions:
  contents: write

jobs:
  create-anime-card:
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“¥ Checkout do repositÃ³rio
        uses: actions/checkout@v4
      
      - name: âš™ï¸ Instalar dependÃªncias
        run: |
          sudo apt-get update -y
          sudo apt-get install -y curl jq imagemagick
      
      - name: ðŸ–¼ï¸ Buscar avatar do GitHub
        id: get-avatar
        run: |
          USER="${{ github.event.inputs.github_user }}"
          echo "ðŸ” Buscando avatar para usuÃ¡rio: $USER"
          
          # URL do avatar do GitHub
          AVATAR_URL="https://github.com/$USER.png?size=200"
          echo "avatar_url=$AVATAR_URL" >> $GITHUB_OUTPUT
          echo "âœ… Avatar: $AVATAR_URL"
      
      - name: ðŸŽ¨ Preparar diretÃ³rio
        run: mkdir -p cards
      
      - name: ðŸ–¼ï¸ Criar Card Anime
        run: |
          # VariÃ¡veis dos inputs
          HERO_NAME="${{ github.event.inputs.hero_name }}"
          HERO_CLASS="${{ github.event.inputs.hero_class }}"
          GUILD="${{ github.event.inputs.guild }}"
          SPECIES="${{ github.event.inputs.species }}"
          BACKSTORY="${{ github.event.inputs.backstory }}"
          RANKING="${{ github.event.inputs.ranking }}"
          AVATAR_URL="${{ steps.get-avatar.outputs.avatar_url }}"
          
          # Stats
          STR="${{ github.event.inputs.strength }}"
          HEALTH="${{ github.event.inputs.health }}"
          MAGIC="${{ github.event.inputs.magic }}"
          DEX="${{ github.event.inputs.dexterity }}"
          AGI="${{ github.event.inputs.agility }}"
          LUCK="${{ github.event.inputs.luck }}"
          
          # Skills
          SKILL1="${{ github.event.inputs.skill_1 }}"
          SKILL2="${{ github.event.inputs.skill_2 }}"
          SKILL3="${{ github.event.inputs.skill_3 }}"
          SKILL4="${{ github.event.inputs.skill_4 }}"
          
          # Data
          DATE=$(date +'%d/%m/%Y')
          CARD_ID=$(date +%s | tail -c 4)
          
          # Cores anime
          RANK_S="#FFD700"
          RANK_A="#FF6B6B"
          RANK_B="#4ECDC4"
          RANK_C="#95E1D3"
          
          # Cor do ranking
          case "$RANKING" in
            "S") RANK_COLOR="$RANK_S" ;;
            "A") RANK_COLOR="$RANK_A" ;;
            "B") RANK_COLOR="$RANK_B" ;;
            "C") RANK_COLOR="$RANK_C" ;;
            *) RANK_COLOR="#00B4D8" ;;
          esac
          
          # Barras de stats
          STR_BAR=$((STR * 12))
          HEALTH_BAR=$((HEALTH * 12))
          MAGIC_BAR=$((MAGIC * 12))
          DEX_BAR=$((DEX * 12))
          AGI_BAR=$((AGI * 12))
          LUCK_BAR=$((LUCK * 12))
          
          # Nome do arquivo
          FILENAME=$(echo "$HERO_NAME" | tr ' ' '_' | tr -cd '[:alnum:]_')
          SVG_FILE="cards/${FILENAME}_anime.svg"
          
          # Criar SVG
          cat > "$SVG_FILE" << EOF
          <svg xmlns="http://www.w3.org/2000/svg" width="450" height="650" viewBox="0 0 450 650">
          <defs>
            <!-- Gradientes -->
            <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#0F0F23"/>
              <stop offset="100%" stop-color="#1A1A2E"/>
            </linearGradient>
            
            <linearGradient id="statGradient" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#00B4D8"/>
              <stop offset="100%" stop-color="#0077B6"/>
            </linearGradient>
            
            <linearGradient id="headerGradient" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#FF6B6B"/>
              <stop offset="100%" stop-color="#FF8E8E"/>
            </linearGradient>
            
            <!-- Filtros -->
            <filter id="shadow">
              <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.5"/>
            </filter>
            
            <filter id="glow">
              <feGaussianBlur stdDeviation="3" result="blur"/>
              <feMerge>
                <feMergeNode in="blur"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
            
            <!-- Clip path para a foto -->
            <clipPath id="avatarClip">
              <circle cx="225" cy="120" r="55"/>
            </clipPath>
          </defs>
          
          <!-- Fundo -->
          <rect width="450" height="650" rx="25" fill="url(#bgGradient)"/>
          
          <!-- Card principal -->
          <rect x="25" y="25" width="400" height="600" rx="20" fill="#16162E" stroke="#00B4D8" stroke-width="2" opacity="0.9"/>
          
          <!-- CabeÃ§alho com gradiente -->
          <rect x="25" y="25" width="400" height="80" rx="20" fill="url(#headerGradient)" opacity="0.8"/>
          
          <!-- Foto do avatar -->
          <circle cx="225" cy="120" r="58" fill="#00B4D8" opacity="0.3"/>
          <circle cx="225" cy="120" r="55" fill="#1A1A2E"/>
          <image href="$AVATAR_URL" x="170" y="65" width="110" height="110" clip-path="url(#avatarClip)"/>
          <circle cx="225" cy="120" r="55" fill="none" stroke="#00B4D8" stroke-width="3" opacity="0.6"/>
          
          <!-- Nome do herÃ³i -->
          <text x="225" y="190" text-anchor="middle" font-family="Arial" font-size="26" font-weight="bold" fill="white">$HERO_NAME</text>
          
          <!-- Classe -->
          <rect x="175" y="200" width="100" height="30" rx="15" fill="#00B4D8" opacity="0.7"/>
          <text x="225" y="220" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold" fill="white">$HERO_CLASS</text>
          
          <!-- Info Grid -->
          <g transform="translate(50, 240)">
            <!-- Guilda -->
            <rect x="0" y="0" width="150" height="40" rx="10" fill="#252547" opacity="0.8"/>
            <text x="10" y="15" font-family="Arial" font-size="11" fill="#A0A0C0">GUILDA</text>
            <text x="10" y="30" font-family="Arial" font-size="12" font-weight="bold" fill="white">$GUILD</text>
            
            <!-- EspÃ©cie -->
            <rect x="170" y="0" width="150" height="40" rx="10" fill="#252547" opacity="0.8"/>
            <text x="180" y="15" font-family="Arial" font-size="11" fill="#A0A0C0">ESPÃ‰CIE</text>
            <text x="180" y="30" font-family="Arial" font-size="12" font-weight="bold" fill="white">$SPECIES</text>
          </g>
          
          <!-- HistÃ³ria -->
          <g transform="translate(50, 300)">
            <rect x="0" y="0" width="350" height="60" rx="10" fill="#252547" opacity="0.8"/>
            <text x="10" y="20" font-family="Arial" font-size="13" fill="#00B4D8" font-weight="bold">HISTÃ“RIA</text>
            <text x="10" y="40" font-family="Arial" font-size="11" fill="#E0E0FF">$BACKSTORY</text>
          </g>
          
          <!-- Stats -->
          <g transform="translate(50, 380)">
            <text x="0" y="0" font-family="Arial" font-size="16" fill="#00B4D8" font-weight="bold">ATRIBUTOS</text>
            
            <!-- Grid de stats -->
            <g transform="translate(0, 25)">
              <!-- Linha 1 -->
              <g>
                <text x="0" y="15" font-family="Arial" font-size="12" fill="#C0C0E0">FORÃ‡A</text>
                <rect x="70" y="5" width="100" height="10" rx="5" fill="#2A2A4A"/>
                <rect x="70" y="5" width="$STR_BAR" height="10" rx="5" fill="url(#statGradient)"/>
                <text x="175" y="13" font-family="Arial" font-size="11" fill="white">$STR</text>
              </g>
              
              <g transform="translate(180, 0)">
                <text x="0" y="15" font-family="Arial" font-size="12" fill="#C0C0E0">SAÃšDE</text>
                <rect x="70" y="5" width="100" height="10" rx="5" fill="#2A2A4A"/>
                <rect x="70" y="5" width="$HEALTH_BAR" height="10" rx="5" fill="url(#statGradient)"/>
                <text x="175" y="13" font-family="Arial" font-size="11" fill="white">$HEALTH</text>
              </g>
              
              <!-- Linha 2 -->
              <g transform="translate(0, 40)">
                <text x="0" y="15" font-family="Arial" font-size="12" fill="#C0C0E0">MAGIA</text>
                <rect x="70" y="5" width="100" height="10" rx="5" fill="#2A2A4A"/>
                <rect x="70" y="5" width="$MAGIC_BAR" height="10" rx="5" fill="url(#statGradient)"/>
                <text x="175" y="13" font-family="Arial" font-size="11" fill="white">$MAGIC</text>
              </g>
              
              <g transform="translate(180, 40)">
                <text x="0" y="15" font-family="Arial" font-size="12" fill="#C0C0E0">DESTREZA</text>
                <rect x="70" y="5" width="100" height="10" rx="5" fill="#2A2A4A"/>
                <rect x="70" y="5" width="$DEX_BAR" height="10" rx="5" fill="url(#statGradient)"/>
                <text x="175" y="13" font-family="Arial" font-size="11" fill="white">$DEX</text>
              </g>
              
              <!-- Linha 3 -->
              <g transform="translate(0, 80)">
                <text x="0" y="15" font-family="Arial" font-size="12" fill="#C0C0E0">AGILIDADE</text>
                <rect x="70" y="5" width="100" height="10" rx="5" fill="#2A2A4A"/>
                <rect x="70" y="5" width="$AGI_BAR" height="10" rx="5" fill="url(#statGradient)"/>
                <text x="175" y="13" font-family="Arial" font-size="11" fill="white">$AGI</text>
              </g>
              
              <g transform="translate(180, 80)">
                <text x="0" y="15" font-family="Arial" font-size="12" fill="#C0C0E0">SORTE</text>
                <rect x="70" y="5" width="100" height="10" rx="5" fill="#2A2A4A"/>
                <rect x="70" y="5" width="$LUCK_BAR" height="10" rx="5" fill="url(#statGradient)"/>
                <text x="175" y="13" font-family="Arial" font-size="11" fill="white">$LUCK</text>
              </g>
            </g>
          </g>
          
          <!-- Habilidades -->
          <g transform="translate(50, 500)">
            <text x="0" y="0" font-family="Arial" font-size="16" fill="#00B4D8" font-weight="bold">HABILIDADES</text>
            <rect x="0" y="10" width="350" height="80" rx="10" fill="#252547" opacity="0.8"/>
            
            <g transform="translate(15, 30)">
              <!-- Coluna 1 -->
              <g>
EOF

          # Skills coluna 1
          SKILL_Y=0
          if [ -n "$SKILL1" ]; then
            echo "                <text x=\"0\" y=\"$SKILL_Y\" font-family=\"Arial\" font-size=\"12\" fill=\"#FFD166\">âœ¦ $SKILL1</text>" >> "$SVG_FILE"
            SKILL_Y=$((SKILL_Y + 20))
          fi
          
          if [ -n "$SKILL2" ]; then
            echo "                <text x=\"0\" y=\"$SKILL_Y\" font-family=\"Arial\" font-size=\"12\" fill=\"#FFD166\">âœ¦ $SKILL2</text>" >> "$SVG_FILE"
            SKILL_Y=$((SKILL_Y + 20))
          fi
          
          echo "              </g>" >> "$SVG_FILE"
          
          # Skills coluna 2
          echo "              <g transform=\"translate(180, 0)\">" >> "$SVG_FILE"
          SKILL_Y=0
          
          if [ -n "$SKILL3" ]; then
            echo "                <text x=\"0\" y=\"$SKILL_Y\" font-family=\"Arial\" font-size=\"12\" fill=\"#FFD166\">âœ¦ $SKILL3</text>" >> "$SVG_FILE"
            SKILL_Y=$((SKILL_Y + 20))
          fi
          
          if [ -n "$SKILL4" ]; then
            echo "                <text x=\"0\" y=\"$SKILL_Y\" font-family=\"Arial\" font-size=\"12\" fill=\"#FFD166\">âœ¦ $SKILL4</text>" >> "$SVG_FILE"
          fi
          
          # Slots vazios
          SKILL_COUNT=0
          [ -n "$SKILL1" ] && SKILL_COUNT=$((SKILL_COUNT + 1))
          [ -n "$SKILL2" ] && SKILL_COUNT=$((SKILL_COUNT + 1))
          [ -n "$SKILL3" ] && SKILL_COUNT=$((SKILL_COUNT + 1))
          [ -n "$SKILL4" ] && SKILL_COUNT=$((SKILL_COUNT + 1))
          
          if [ $SKILL_COUNT -lt 4 ]; then
            for ((i=SKILL_COUNT; i<4; i++)); do
              if [ $i -lt 2 ]; then
                POS_Y=$((i * 20))
                echo "                <text x=\"0\" y=\"$POS_Y\" font-family=\"Arial\" font-size=\"12\" fill=\"#666699\" opacity=\"0.5\">âœ¦ [Vazio]</text>" >> "$SVG_FILE"
              else
                POS_Y=$(((i-2) * 20))
                echo "                <text x=\"0\" y=\"$POS_Y\" font-family=\"Arial\" font-size=\"12\" fill=\"#666699\" opacity=\"0.5\">âœ¦ [Vazio]</text>" >> "$SVG_FILE"
              fi
            done
          fi
          
          cat >> "$SVG_FILE" << EOF
              </g>
            </g>
          </g>
          
          <!-- Ranking -->
          <g transform="translate(50, 590)">
            <rect x="0" y="0" width="350" height="40" rx="20" fill="#252547" opacity="0.8"/>
            <text x="20" y="25" font-family="Arial" font-size="16" fill="#00B4D8" font-weight="bold">CLASSIFICAÃ‡ÃƒO</text>
            
            <!-- Badge do ranking -->
            <circle cx="310" cy="20" r="15" fill="$RANK_COLOR" opacity="0.9"/>
            <text x="310" y="26" text-anchor="middle" font-family="Arial" font-size="20" font-weight="bold" fill="white">$RANKING</text>
          </g>
          
          <!-- RodapÃ© -->
          <g transform="translate(50, 635)">
            <text x="0" y="0" font-family="Arial" font-size="10" fill="#8888AA">Gerado: $DATE</text>
            <text x="300" y="0" font-family="Arial" font-size="10" fill="#8888AA" text-anchor="end">ID: $CARD_ID</text>
          </g>
          
          <!-- Elementos decorativos -->
          <circle cx="80" cy="80" r="8" fill="#00B4D8" opacity="0.3"/>
          <circle cx="370" cy="80" r="6" fill="#FF6B6B" opacity="0.3"/>
          <circle cx="100" cy="620" r="5" fill="#4ECDC4" opacity="0.3"/>
          
          </svg>
          EOF
          
          echo "âœ… Card anime criado: $SVG_FILE"
          echo "ðŸŽ¨ Design: Anime 2D Minimalista"
          echo "ðŸ‘¤ Avatar: $AVATAR_URL"
      
      - name: ðŸ“¤ Salvar card
        run: |
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"
          
          git add cards/
          git commit -m "ðŸŽ´ Add anime card: ${{ github.event.inputs.hero_name }}" || echo "Sem alteraÃ§Ãµes"
          git push || echo "Push falhou ou sem alteraÃ§Ãµes"
          echo "âœ… Workflow completo!"
