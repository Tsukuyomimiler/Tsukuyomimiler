name: "Genshin Card Maker"

on:
  workflow_dispatch:
    inputs:
      user:
        description: 'GitHub username'
        required: true
        default: 'ciconha'

permissions:
  contents: write

jobs:
  make-card:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v4
      
      - run: mkdir -p cards
      
      - name: Make SVG
        run: |
          USER="${{ github.event.inputs.user }}"
          DATE=$(date +'%Y-%m-%d')
          FILE="cards/${USER}.svg"
          
          cat > "$FILE" << EOF
          <svg width="400" height="200" xmlns="http://www.w3.org/2000/svg">
            <rect width="400" height="200" fill="#0f0f23" rx="10"/>
            <rect x="20" y="20" width="360" height="160" fill="#1a1a2e" rx="10"/>
            
            <text x="40" y="60" font-family="Arial" font-size="24" fill="white">$USER</text>
            <text x="40" y="90" font-family="Arial" font-size="14" fill="#00b4d8">Genshin Developer</text>
            
            <g transform="translate(40, 120)">
              <rect width="80" height="40" rx="5" fill="#252547"/>
              <text x="40" y="25" text-anchor="middle" font-family="Arial" font-size="12" fill="#ccc">Level</text>
              <text x="40" y="45" text-anchor="middle" font-family="Arial" font-size="16" fill="white">42</text>
              
              <rect x="100" width="80" height="40" rx="5" fill="#252547"/>
              <text x="140" y="25" text-anchor="middle" font-family="Arial" font-size="12" fill="#ccc">Rank</text>
              <text x="140" y="45" text-anchor="middle" font-family="Arial" font-size="16" fill="#FFD700">S</text>
              
              <rect x="200" width="80" height="40" rx="5" fill="#252547"/>
              <text x="240" y="25" text-anchor="middle" font-family="Arial" font-size="12" fill="#ccc">XP</text>
              <text x="240" y="45" text-anchor="middle" font-family="Arial" font-size="16" fill="white">9999</text>
            </g>
            
            <text x="40" y="180" font-family="Arial" font-size="10" fill="#888">Created: $DATE</text>
          </svg>
          EOF
          
          echo "Card made for $USER"
      
      - name: Save
        run: |
          git config user.name "actions"
          git config user.email "actions@github.com"
          git add cards/
          git commit -m "Card for ${{ github.event.inputs.user }}" || exit 0
          git push
