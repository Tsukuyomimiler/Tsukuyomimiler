name: "üë®‚Äçüíª DEV PROFILE CARD"

on:
  workflow_dispatch:
    inputs:
      github_username:
        description: 'Seu usu√°rio do GitHub'
        required: true
        default: 'ciconha'
      your_name:
        description: 'Seu nome'
        required: false
        default: 'Desenvolvedor'
      your_title:
        description: 'Seu t√≠tulo/cargo'
        required: false
        default: 'Software Developer'
      main_tech:
        description: 'Tecnologia principal'
        required: false
        default: 'JavaScript'
      secondary_tech:
        description: 'Tecnologia secund√°ria'
        required: false
        default: 'React'

permissions:
  contents: write

jobs:
  generate-card:
    runs-on: ubuntu-latest
    
    steps:
      - name: üì• Baixar c√≥digo
        uses: actions/checkout@v4
      
      - name: üìÅ Criar pasta
        run: mkdir -p cards
      
      - name: üé® Gerar card
        run: |
          USER="${{ github.event.inputs.github_username }}"
          NAME="${{ github.event.inputs.your_name }}"
          TITLE="${{ github.event.inputs.your_title }}"
          TECH1="${{ github.event.inputs.main_tech }}"
          TECH2="${{ github.event.inputs.secondary_tech }}"
          DATE=$(date +'%d/%m/%Y')
          
          # Criar nome de arquivo seguro
          SAFE_NAME=$(echo "$NAME" | tr ' ' '-' | tr -cd '[:alnum:]-')
          if [ -z "$SAFE_NAME" ]; then
            SAFE_NAME="profile"
          fi
          
          FILE="cards/$SAFE_NAME-card.svg"
          
          cat > "$FILE" << 'EOF'
          <svg xmlns="http://www.w3.org/2000/svg" width="450" height="250" viewBox="0 0 450 250">
          <style>
            .header { font-family: 'Segoe UI', Arial, sans-serif; font-size: 26px; font-weight: bold; fill: #2d3748; }
            .subtitle { font-family: 'Segoe UI', Arial, sans-serif; font-size: 14px; fill: #4a5568; }
            .tech { font-family: 'Consolas', 'Monaco', monospace; font-size: 12px; fill: #2d3748; }
            .info { font-family: 'Segoe UI', Arial, sans-serif; font-size: 11px; fill: #718096; }
            .badge { font-family: 'Segoe UI', Arial, sans-serif; font-size: 10px; fill: white; }
          </style>
          
          <!-- Fundo gradiente -->
          <rect width="450" height="250" rx="15" fill="url(#gradient)"/>
          <defs>
            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#f7fafc"/>
              <stop offset="100%" stop-color="#edf2f7"/>
            </linearGradient>
          </defs>
          
          <!-- Card principal -->
          <rect x="25" y="25" width="400" height="200" rx="12" fill="white" stroke="#e2e8f0" stroke-width="1"/>
          
          <!-- Cabe√ßalho -->
          <text x="50" y="65" class="header">
EOF
          
          echo "$NAME" >> "$FILE"
          
          cat >> "$FILE" << 'EOF'
          </text>
          <text x="50" y="85" class="subtitle">
EOF
          
          echo "$TITLE" >> "$FILE"
          
          cat >> "$FILE" << 'EOF'
          </text>
          
          <!-- Avatar do GitHub -->
          <circle cx="375" cy="75" r="30" fill="#e2e8f0"/>
          <image href="https://github.com/
EOF
          
          echo "$USER.png?size=120" >> "$FILE"
          
          cat >> "$FILE" << 'EOF'
          " x="345" y="45" width="60" height="60"/>
          
          <!-- Linha divis√≥ria -->
          <line x1="50" y1="100" x2="400" y2="100" stroke="#e2e8f0" stroke-width="1"/>
          
          <!-- Tech Stack -->
          <text x="50" y="125" class="info">TECNOLOGIAS</text>
          <rect x="50" y="135" width="100" height="25" rx="5" fill="#4299e1"/>
          <text x="100" y="152" class="badge" text-anchor="middle">
EOF
          
          echo "$TECH1" >> "$FILE"
          
          cat >> "$FILE" << 'EOF'
          </text>
          
          <rect x="160" y="135" width="100" height="25" rx="5" fill="#48bb78"/>
          <text x="210" y="152" class="badge" text-anchor="middle">
EOF
          
          echo "$TECH2" >> "$FILE"
          
          cat >> "$FILE" << 'EOF'
          </text>
          
          <!-- GitHub info -->
          <text x="50" y="185" class="info">GITHUB</text>
          <rect x="50" y="195" width="200" height="20" rx="4" fill="#f7fafc"/>
          <text x="60" y="210" class="tech">github.com/
EOF
          
          echo "$USER" >> "$FILE"
          
          cat >> "$FILE" << 'EOF'
          </text>
          
          <!-- Stats -->
          <g transform="translate(270, 140)">
            <rect x="0" y="0" width="50" height="50" rx="8" fill="#fed7d7"/>
            <text x="25" y="20" class="info" text-anchor="middle" font-size="9">PROJ</text>
            <text x="25" y="35" class="header" text-anchor="middle" font-size="16">15+</text>
            
            <rect x="60" y="0" width="50" height="50" rx="8" fill="#c6f6d5"/>
            <text x="85" y="20" class="info" text-anchor="middle" font-size="9">EXP</text>
            <text x="85" y="35" class="header" text-anchor="middle" font-size="16">3y</text>
            
            <rect x="120" y="0" width="50" height="50" rx="8" fill="#bee3f8"/>
            <text x="145" y="20" class="info" text-anchor="middle" font-size="9">LVL</text>
            <text x="145" y="35" class="header" text-anchor="middle" font-size="16">42</text>
          </g>
          
          <!-- Data -->
          <text x="50" y="235" class="info" font-size="9">Criado em: 
EOF
          
          echo "$DATE" >> "$FILE"
          
          cat >> "$FILE" << 'EOF'
          </text>
          
          </svg>
EOF
          
          echo "‚ú® Card gerado com sucesso!"
          echo "üìÅ Salvo em: $FILE"
          echo "üë§ Para: $NAME"
          echo "üíª GitHub: $USER"
      
      - name: üì§ Publicar card
        run: |
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"
          
          # Adicionar e commitar
          git add cards/
          
          # Verificar se h√° mudan√ßas
          if git diff --cached --quiet; then
            echo "üì≠ Nenhuma mudan√ßa para commitar"
          else
            git commit -m "üìÑ Novo card: ${{ github.event.inputs.your_name }}"
            git push
            echo "‚úÖ Card publicado!"
          fi
